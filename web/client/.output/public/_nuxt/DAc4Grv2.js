import{_ as $}from"./DusBHTda.js";import{B as A}from"./DZyT-3wr.js";import{S as E}from"./BC6OM_U-.js";import{I as P}from"./DRQ8spOm.js";import{S as j,O as q}from"./lDd3phAc.js";import"./BiNgaM9F.js";import"./CWvt8Gu3.js";import{F as D,a as z}from"./DcU8bM7c.js";import{T as H}from"./k-1F5wz5.js";import{_ as C}from"./C4Ghd-f4.js";import{p as K,i as Q,h as W,l as X,r as c,e as U,c as v,a as n,b as s,w as r,j as l,q as y,o as u,s as f,g as I,F as k,v as B,d as p,t as F}from"./CbujNTzC.js";import{u as Y}from"./DrTY0QbX.js";import{_ as Z}from"./DlAUqK2U.js";import{M as i}from"./C4FomA2R.js";import"./Do3eBRyU.js";import"./7FLWgqLH.js";import"./Ba22RDed.js";import"./CYhUeftq.js";import"./C2r7KKOo.js";import"./BgSTSfhd.js";const ee={class:"Pageas"},oe={class:"PageContent"},te={class:"ConBox"},ae={class:"RightBox"},le={class:"Items"},se={__name:"add",setup(re){K().params.id;const h=Q();W().init(a=>{a||(i.error("请先登录"),X("/login"))}),Y({title:"添加内容 - "+h.$state.Config.n_web_title});const V=c(!1);U(()=>{V.value=!0});const t=c({n_name:"",n_profile:"",n_html:"",n_category:[],n_topic:[],n_permission:"1"}),d=c([]),N=a=>{d.value=a,console.log("当前资源列表:",d.value)},T=async()=>{let a={...t.value,n_category:JSON.stringify(t.value.n_category),n_topic:JSON.stringify(t.value.n_topic),n_resources:JSON.stringify(d.value),n_haveimage:2,n_havevideo:2};if(d.value.length>0)for(let e in d.value)d.value[e].type==1&&(a.n_haveimage=1),d.value[e].type==2&&(a.n_havevideo=1);try{const e=await y().post("/api/AddThreads",a);e.code==200?i.success("提交成功"):i.error(e.message||"提交失败")}catch(e){i.error(e.message)}},S=c([]),O=async()=>{try{const a=await y().post("/api/GetCategory");a.code==200?S.value=a.data:i.error(a.message||"获取分类列表失败")}catch(a){i.error(a.message)}},b=c([]),G=async()=>{try{const a=await y().post("/api/GetCategory",{type:2});a.code==200?b.value=a.data:i.error(a.message||"获取分类列表失败")}catch(a){i.error(a.message)}};return U(()=>{O(),G()}),(a,e)=>{const w=P,m=z,L=H,R=$,x=D,_=q,g=j,J=E,M=A;return u(),v("div",ee,[n("div",oe,[n("div",te,[e[8]||(e[8]=n("div",{class:"title"},[n("img",{src:C,alt:""}),n("span",null,"发布贴贴")],-1)),s(x,{model:l(t),layout:"vertical"},{default:r(()=>[s(m,{field:"name",label:"标题"},{default:r(()=>[s(w,{class:"road",modelValue:l(t).n_name,"onUpdate:modelValue":e[0]||(e[0]=o=>l(t).n_name=o),placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),s(m,{field:"post",label:"简介"},{default:r(()=>[s(L,{class:"road",modelValue:l(t).n_profile,"onUpdate:modelValue":e[1]||(e[1]=o=>l(t).n_profile=o),placeholder:"请输入简介","max-length":100,"allow-clear":"","show-word-limit":""},null,8,["modelValue"])]),_:1}),s(m,{field:"post",label:"详情"},{default:r(()=>[l(V)?(u(),f(R,{key:0,modelValue:l(t).n_html,"onUpdate:modelValue":e[2]||(e[2]=o=>l(t).n_html=o),height:200,"onUpdate:resources":N},null,8,["modelValue"])):I("",!0)]),_:1})]),_:1},8,["model"])]),n("div",ae,[n("div",le,[e[13]||(e[13]=n("div",{class:"title"},[n("img",{src:C,alt:""}),n("span",null,"确认信息")],-1)),s(x,{model:l(t),layout:"vertical"},{default:r(()=>[s(m,{field:"post",label:"分类"},{default:r(()=>[s(g,{multiple:"",class:"road","max-tag-count":2,"allow-clear":"",modelValue:l(t).n_category,"onUpdate:modelValue":e[3]||(e[3]=o=>l(t).n_category=o),placeholder:"请选择分类"},{default:r(()=>[(u(!0),v(k,null,B(l(S),o=>(u(),f(_,{key:o.id,value:o.id},{default:r(()=>[p(F(o.n_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(m,{field:"post",label:"话题"},{default:r(()=>[s(g,{multiple:"",class:"road","max-tag-count":2,"allow-clear":"",modelValue:l(t).n_topic,"onUpdate:modelValue":e[4]||(e[4]=o=>l(t).n_topic=o),placeholder:"请选择话题"},{default:r(()=>[(u(!0),v(k,null,B(l(b),o=>(u(),f(_,{key:o.id,value:o.id},{default:r(()=>[p(F(o.n_name),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(m,{field:"post",label:"权限"},{default:r(()=>[s(J,null,{default:r(()=>[s(g,{class:"road",modelValue:l(t).n_permission,"onUpdate:modelValue":e[5]||(e[5]=o=>l(t).n_permission=o),placeholder:"请选择"},{default:r(()=>[s(_,{value:"1"},{default:r(()=>[...e[9]||(e[9]=[p("免费公开",-1)])]),_:1}),s(_,{value:"2"},{default:r(()=>[...e[10]||(e[10]=[p("积分公开",-1)])]),_:1}),s(_,{value:"3"},{default:r(()=>[...e[11]||(e[11]=[p("付费公开",-1)])]),_:1})]),_:1},8,["modelValue"]),l(t).n_permission!=="1"?(u(),f(w,{key:0,class:"road",modelValue:l(t).n_price,"onUpdate:modelValue":e[6]||(e[6]=o=>l(t).n_price=o),placeholder:"请输入价格"},null,8,["modelValue"])):I("",!0)]),_:1})]),_:1}),s(m,{field:"post",label:""},{default:r(()=>[s(M,{type:"primary",class:"road",onClick:e[7]||(e[7]=o=>T())},{default:r(()=>[...e[12]||(e[12]=[p("提交",-1)])]),_:1})]),_:1})]),_:1},8,["model"])])])])])}}},Fe=Z(se,[["__scopeId","data-v-75ef484e"]]);export{Fe as default};
