import{B as Ce,C as be,m as E,c as y,o as S,g as F,b as M,D as we,k as ye,n as O,t as D,w as ee,a as Se,K as ae,as as ze,Q as Be,E as Le,r as d,G as v,U as P,T as z,e as Ve,ac as $e,Z as te,a5 as Ie,a7 as Re,H as Te,I as xe}from"./CbujNTzC.js";import{R as He}from"./CWvt8Gu3.js";import{I as Ne,b as le}from"./C4FomA2R.js";import{a as ke,p as Ae,o as Ee}from"./DRQ8spOm.js";import{u as Fe}from"./DZyT-3wr.js";const Me=["border-width","box-sizing","font-family","font-weight","font-size","font-variant","letter-spacing","line-height","padding-top","padding-bottom","padding-left","padding-right","text-indent","text-rendering","text-transform","white-space","overflow-wrap","width"],Oe=e=>{const t={};return Me.forEach(f=>{t[f]=e.getPropertyValue(f)}),t},De=be({name:"Textarea",components:{ResizeObserver:He,IconHover:Ne,IconClose:ze},inheritAttrs:!1,props:{modelValue:String,defaultValue:{type:String,default:""},placeholder:String,disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},maxLength:{type:[Number,Object],default:0},showWordLimit:{type:Boolean,default:!1},allowClear:{type:Boolean,default:!1},autoSize:{type:[Boolean,Object],default:!1},wordLength:{type:Function},wordSlice:{type:Function},textareaAttrs:{type:Object}},emits:{"update:modelValue":e=>!0,input:(e,t)=>!0,change:(e,t)=>!0,clear:e=>!0,focus:e=>!0,blur:e=>!0},setup(e,{emit:t,attrs:f}){const{disabled:W,error:U,modelValue:h}=Be(e),m=Le("textarea"),{mergedDisabled:c,mergedError:B,eventHandlers:o}=Fe({disabled:W,error:U}),s=d(),G=d(),p=d(),K=d(),L=d(e.defaultValue),i=v(()=>{var a;return(a=h.value)!=null?a:L.value}),[oe,ne]=ke(s);P(h,a=>{(Ie(a)||Re(a))&&(L.value="")});const C=v(()=>z(e.maxLength)&&!!e.maxLength.errorOnly),u=v(()=>z(e.maxLength)?e.maxLength.length:e.maxLength),b=a=>{var l;return $e(e.wordLength)?e.wordLength(a):(l=a.length)!=null?l:0},Q=v(()=>b(i.value)),Z=v(()=>B.value||!!(u.value&&C.value&&Q.value>u.value)),g=d(!1),V=d(!1),re=v(()=>e.allowClear&&!c.value&&i.value),$=d(!1),q=d(""),I=()=>{oe(),te(()=>{s.value&&i.value!==s.value.value&&(s.value.value=i.value,ne())})},w=(a,l=!0)=>{var n,r;u.value&&!C.value&&b(a)>u.value&&(a=(r=(n=e.wordSlice)==null?void 0:n.call(e,a,u.value))!=null?r:a.slice(0,u.value)),L.value=a,l&&t("update:modelValue",a),I()};let R=i.value;const J=(a,l)=>{var n,r;a!==R&&(R=a,t("change",a,l),(r=(n=o.value)==null?void 0:n.onChange)==null||r.call(n,l))},se=a=>{var l,n;V.value=!0,R=i.value,t("focus",a),(n=(l=o.value)==null?void 0:l.onFocus)==null||n.call(l,a)},ue=a=>{var l,n;V.value=!1,t("blur",a),(n=(l=o.value)==null?void 0:l.onBlur)==null||n.call(l,a),J(i.value,a)},ie=a=>{var l,n;const{value:r}=a.target;if(a.type==="compositionend"){if($.value=!1,q.value="",u.value&&!C.value&&i.value.length>=u.value&&b(r)>u.value){I();return}t("input",r,a),w(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}else $.value=!0},de=a=>{var l,n;const{value:r}=a.target;if($.value)q.value=r;else{if(u.value&&!C.value&&i.value.length>=u.value&&b(r)>u.value&&a.inputType==="insertText"){I();return}t("input",r,a),w(r),(n=(l=o.value)==null?void 0:l.onInput)==null||n.call(l,a)}},ve=a=>{w(""),J("",a),t("clear",a)};P(h,a=>{a!==i.value&&w(a??"",!1)});const fe=a=>Ee(f,le),X=a=>Ae(f,le),me=X(),ce=v(()=>{const a={...me,...e.textareaAttrs};return Z.value&&(a["aria-invalid"]=!0),a}),ge=v(()=>[`${m}-wrapper`,{[`${m}-focus`]:V.value,[`${m}-disabled`]:c.value,[`${m}-error`]:Z.value,[`${m}-scroll`]:g.value}]);let Y;const T=d(0),x=d(0),H=v(()=>!z(e.autoSize)||!e.autoSize.minRows?0:e.autoSize.minRows*T.value+x.value),N=v(()=>!z(e.autoSize)||!e.autoSize.maxRows?0:e.autoSize.maxRows*T.value+x.value),k=()=>{const a=Oe(Y);T.value=Number.parseInt(a["line-height"]||0,10),x.value=Number.parseInt(a["border-width"]||0,10)*2+Number.parseInt(a["padding-top"]||0,10)+Number.parseInt(a["padding-bottom"]||0,10),K.value=a,te(()=>{var l;const n=(l=p.value)==null?void 0:l.offsetHeight;let r=n??0,_="hidden";H.value&&r<H.value&&(r=H.value),N.value&&r>N.value&&(r=N.value,_="auto"),G.value={height:`${r}px`,resize:"none",overflow:_}})};Ve(()=>{s.value&&(Y=window.getComputedStyle(s.value),e.autoSize&&k()),A()});const he=()=>{e.autoSize&&p.value&&k(),A()},pe=a=>{s.value&&a.target!==s.value&&(a.preventDefault(),s.value.focus())},A=()=>{s.value&&(s.value.scrollHeight>s.value.offsetHeight?g.value||(g.value=!0):g.value&&(g.value=!1))};return P(i,()=>{e.autoSize&&p.value&&k(),A()}),{prefixCls:m,wrapperCls:ge,textareaRef:s,textareaStyle:G,mirrorRef:p,mirrorStyle:K,computedValue:i,showClearBtn:re,valueLength:Q,computedMaxLength:u,mergedDisabled:c,mergeTextareaAttrs:ce,getWrapperAttrs:fe,getTextareaAttrs:X,handleInput:de,handleFocus:se,handleBlur:ue,handleComposition:ie,handleClear:ve,handleResize:he,handleMousedown:pe}},methods:{focus(){var e;(e=this.$refs.textareaRef)==null||e.focus()},blur(){var e;(e=this.$refs.textareaRef)==null||e.blur()}}}),Pe=["disabled","value","placeholder"];function je(e,t,f,W,U,h){const m=E("resize-observer"),c=E("icon-close"),B=E("icon-hover");return S(),y("div",ae(e.getWrapperAttrs(e.$attrs),{class:e.wrapperCls,onMousedown:t[7]||(t[7]=(...o)=>e.handleMousedown&&e.handleMousedown(...o))}),[e.autoSize?(S(),y("div",{key:0,ref:"mirrorRef",class:O(`${e.prefixCls}-mirror`),style:ye(e.mirrorStyle)},D(`${e.computedValue}
`),7)):F("v-if",!0),M(m,{onResize:e.handleResize},{default:ee(()=>[Se("textarea",ae({ref:"textareaRef"},e.mergeTextareaAttrs,{disabled:e.mergedDisabled,class:e.prefixCls,style:e.textareaStyle,value:e.computedValue,placeholder:e.placeholder,onInput:t[0]||(t[0]=(...o)=>e.handleInput&&e.handleInput(...o)),onFocus:t[1]||(t[1]=(...o)=>e.handleFocus&&e.handleFocus(...o)),onBlur:t[2]||(t[2]=(...o)=>e.handleBlur&&e.handleBlur(...o)),onCompositionstart:t[3]||(t[3]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionupdate:t[4]||(t[4]=(...o)=>e.handleComposition&&e.handleComposition(...o)),onCompositionend:t[5]||(t[5]=(...o)=>e.handleComposition&&e.handleComposition(...o))}),null,16,Pe)]),_:1},8,["onResize"]),we(e.$slots,"suffix"),e.computedMaxLength&&e.showWordLimit?(S(),y("div",{key:1,class:O(`${e.prefixCls}-word-limit`)},D(e.valueLength)+"/"+D(e.computedMaxLength),3)):F("v-if",!0),e.showClearBtn?(S(),y("div",{key:2,class:O(`${e.prefixCls}-clear-btn`),onClick:t[6]||(t[6]=(...o)=>e.handleClear&&e.handleClear(...o))},[M(B,null,{default:ee(()=>[M(c)]),_:1})],2)):F("v-if",!0)],16)}var j=Ce(De,[["render",je]]);const Ze=Object.assign(j,{install:(e,t)=>{Te(e,t);const f=xe(t);e.component(f+j.name,j)}});export{Ze as T};
