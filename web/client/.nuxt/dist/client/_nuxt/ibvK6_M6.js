import{B as M}from"./DZyT-3wr.js";import{F as P,a as R}from"./DcU8bM7c.js";import{I as j}from"./DRQ8spOm.js";import{aO as q,i as A,r as c,c as k,a as n,g,j as o,b as l,w as s,m as _,o as v,d as m,s as L,t as B,q as b,l as D}from"./CbujNTzC.js";import{s as E}from"./BhBtA1CP.js";import{_ as O}from"./DlAUqK2U.js";import{M as r}from"./C4FomA2R.js";import"./Ba22RDed.js";import"./7FLWgqLH.js";import"./C2r7KKOo.js";const z={key:0,class:"LoginBox"},G={key:1,class:"LoginBox"},J={key:2,class:"LoginBox"},K={__name:"login",setup(Q){const $=q("UToken"),C=A(),u=c(0),t=c({}),S=async()=>{const i=await b().post("/api/login",t.value);i.code==200?(r.success("登录成功"),$.value=i.data,D("/")):r.error(i.msg)},F=async()=>{const i=await b().post("/api/register",t.value);i.code==200?(r.success("注册成功"),u.value=0):r.error(i.msg)},N=async()=>{const i=await b().post("/api/RetrievePassword",t.value);i.code==200?(r.success("找回成功"),u.value=0):r.error(i.msg)},x=c(!1),U=async()=>{if(f.value>0){r.warning(`请等待 ${f.value} 秒后重试`);return}if(!t.value.username||t.value.username.length<1){r.warning("请输入邮箱");return}x.value=!0;const i=await b().post("/api/sendVerificationCode",{to:t.value.username});x.value=!1,i.code==200?(r.success("发送成功"),H()):r.error(i.msg)},f=c(0),V=c("获取验证码"),H=()=>{f.value=60;const i=E(()=>{f.value--,f.value<=0?(clearInterval(i),V.value="获取验证码"):V.value=`${f.value}秒后重试`},1e3)};return(i,e)=>{const w=_("icon-user"),p=j,y=_("icon-lock"),d=M,T=R,I=P;return v(),k("div",null,[e[26]||(e[26]=n("div",{class:"LoginTop"},null,-1)),o(u)==0?(v(),k("div",z,[e[17]||(e[17]=n("div",{class:"LoginTopInfo"},[n("p",{class:"LoginTopInfocs"},"Hi! User!"),n("p",{class:"LoginTopInfoTitle"},"欢迎回来，尊敬的用户")],-1)),l(I,{model:o(t),layout:"vertical",onSubmit:S},{default:s(()=>[l(p,{placeholder:"请输入账号",type:"text","allow-clear":"",modelValue:o(t).username,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).username=a),class:"input"},{prefix:s(()=>[l(w)]),_:1},8,["modelValue"]),l(p,{placeholder:"请输入密码","allow-clear":"",type:"password",modelValue:o(t).password,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).password=a),class:"input"},{prefix:s(()=>[l(y)]),_:1},8,["modelValue"]),l(T,{hideLabel:!0},{default:s(()=>[l(d,{class:"loginbut",type:"primary","html-type":"submit"},{default:s(()=>[...e[13]||(e[13]=[m("立即登录",-1)])]),_:1})]),_:1}),n("p",null,[e[16]||(e[16]=n("span",null,"没有账号？",-1)),l(d,{type:"text",onClick:e[2]||(e[2]=a=>u.value=1)},{default:s(()=>[...e[14]||(e[14]=[m("立即注册",-1)])]),_:1}),o(C).$state.Config.n_captcha_type=="1"?(v(),L(d,{key:0,type:"text",onClick:e[3]||(e[3]=a=>u.value=2)},{default:s(()=>[...e[15]||(e[15]=[m("忘记密码?",-1)])]),_:1})):g("",!0)])]),_:1},8,["model"])])):g("",!0),o(u)==1?(v(),k("div",G,[e[21]||(e[21]=n("div",{class:"LoginTopInfo"},[n("p",{class:"LoginTopInfocs"},"Hi! User!"),n("p",{class:"LoginTopInfoTitle"},"欢迎注册！")],-1)),l(I,{model:o(t),layout:"vertical",onSubmit:F},{default:s(()=>[l(p,{placeholder:"请输入昵称",type:"text","allow-clear":"",modelValue:o(t).nickname,"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).nickname=a),class:"input"},{prefix:s(()=>[l(w)]),_:1},8,["modelValue"]),l(p,{placeholder:"请输入邮箱",type:"text","allow-clear":"",modelValue:o(t).username,"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).username=a),class:"input"},{prefix:s(()=>[l(w)]),_:1},8,["modelValue"]),l(p,{placeholder:"请输入密码","allow-clear":"",type:"password",modelValue:o(t).password,"onUpdate:modelValue":e[6]||(e[6]=a=>o(t).password=a),class:"input"},{prefix:s(()=>[l(y)]),_:1},8,["modelValue"]),o(C).$state.Config.n_captcha_type=="1"?(v(),L(p,{key:0,placeholder:"请输入验证码","allow-clear":"",type:"text",modelValue:o(t).code,"onUpdate:modelValue":e[7]||(e[7]=a=>o(t).code=a),class:"input"},{prefix:s(()=>[l(y)]),suffix:s(()=>[l(d,{type:"text",loading:o(x),onClick:U,disabled:o(f)>0},{default:s(()=>[m(B(o(V)),1)]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])):g("",!0),l(T,{hideLabel:!0},{default:s(()=>[l(d,{class:"loginbut",type:"primary","html-type":"submit"},{default:s(()=>[...e[18]||(e[18]=[m("立即登录",-1)])]),_:1})]),_:1}),n("p",null,[e[20]||(e[20]=n("span",null,"已有账号？",-1)),l(d,{type:"text",onClick:e[8]||(e[8]=a=>u.value=0)},{default:s(()=>[...e[19]||(e[19]=[m("返回登录",-1)])]),_:1})])]),_:1},8,["model"])])):g("",!0),o(u)==2?(v(),k("div",J,[e[25]||(e[25]=n("div",{class:"LoginTopInfo"},[n("p",{class:"LoginTopInfocs"},"Hi! User!"),n("p",{class:"LoginTopInfoTitle"},"下次可不能忘记密码了哦！")],-1)),l(I,{model:o(t),layout:"vertical",onSubmit:N},{default:s(()=>[l(p,{placeholder:"请输入邮箱",type:"text","allow-clear":"",modelValue:o(t).username,"onUpdate:modelValue":e[9]||(e[9]=a=>o(t).username=a),class:"input"},{prefix:s(()=>[l(w)]),_:1},8,["modelValue"]),o(C).$state.Config.n_captcha_type=="1"?(v(),L(p,{key:0,placeholder:"请输入验证码","allow-clear":"",type:"text",modelValue:o(t).code,"onUpdate:modelValue":e[10]||(e[10]=a=>o(t).code=a),class:"input"},{prefix:s(()=>[l(y)]),suffix:s(()=>[l(d,{type:"text",loading:o(x),onClick:U,disabled:o(f)>0},{default:s(()=>[m(B(o(V)),1)]),_:1},8,["loading","disabled"])]),_:1},8,["modelValue"])):g("",!0),l(p,{placeholder:"请输入新密码","allow-clear":"",type:"password",modelValue:o(t).password,"onUpdate:modelValue":e[11]||(e[11]=a=>o(t).password=a),class:"input"},{prefix:s(()=>[l(y)]),_:1},8,["modelValue"]),l(T,{hideLabel:!0},{default:s(()=>[l(d,{class:"loginbut",type:"primary","html-type":"submit"},{default:s(()=>[...e[22]||(e[22]=[m("立即登录",-1)])]),_:1})]),_:1}),n("p",null,[e[24]||(e[24]=n("span",null,"已有账号？",-1)),l(d,{type:"text",onClick:e[12]||(e[12]=a=>u.value=0)},{default:s(()=>[...e[23]||(e[23]=[m("返回登录",-1)])]),_:1})])]),_:1},8,["model"])])):g("",!0)])}}},ae=O(K,[["__scopeId","data-v-a391bbf2"]]);export{ae as default};
