import{C as J,Q as X,E as Z,r as w,G as B,aj as c,U as E,b as s,aM as ee,aE as ne,F as ae,af as ue,ae as le,a5 as te,H as ie,I as re}from"./CbujNTzC.js";import{i as V}from"./BW_FzNZC.js";import{u as oe,a as de,B as R}from"./DZyT-3wr.js";import{I as se}from"./DRQ8spOm.js";import{g as ce,K as z}from"./CYhUeftq.js";const fe=800,ve=150;V.enableBoundaryChecking(!1);var I=J({name:"InputNumber",props:{modelValue:Number,defaultValue:Number,mode:{type:String,default:"embed"},precision:Number,step:{type:Number,default:1},disabled:{type:Boolean,default:!1},error:{type:Boolean,default:!1},max:{type:Number,default:1/0},min:{type:Number,default:-1/0},formatter:{type:Function},parser:{type:Function},placeholder:String,hideButton:{type:Boolean,default:!1},size:{type:String},allowClear:{type:Boolean,default:!1},modelEvent:{type:String,default:"change"},readOnly:{type:Boolean,default:!1},inputAttrs:{type:Object}},emits:{"update:modelValue":n=>!0,change:(n,t)=>!0,focus:n=>!0,blur:n=>!0,clear:n=>!0,input:(n,t,l)=>!0,keydown:n=>!0},setup(n,{emit:t,slots:l}){var S;const{size:P,disabled:F}=X(n),r=Z("input-number"),M=w(),{mergedSize:A,mergedDisabled:f,eventHandlers:K}=oe({size:P,disabled:F}),{mergedSize:g}=de(A),y=B(()=>{if(c(n.precision)){const e=`${n.step}`.split(".")[1],a=e&&e.length||0;return Math.max(a,n.precision)}}),_=e=>{var a,u;if(!c(e))return"";const d=y.value?e.toFixed(y.value):String(e);return(u=(a=n.formatter)==null?void 0:a.call(n,d))!=null?u:d},o=w(_((S=n.modelValue)!=null?S:n.defaultValue)),i=B(()=>{var e,a;if(!o.value)return;const u=Number((a=(e=n.parser)==null?void 0:e.call(n,o.value))!=null?a:o.value);return Number.isNaN(u)?void 0:u}),m=w(c(i.value)&&i.value<=n.min),b=w(c(i.value)&&i.value>=n.max);let x=0;const v=()=>{x&&(window.clearTimeout(x),x=0)},$=e=>{if(!te(e))return c(n.min)&&e<n.min&&(e=n.min),c(n.max)&&e>n.max&&(e=n.max),c(y.value)?V.round(e,y.value):e},h=e=>{let a=!1,u=!1;c(e)&&(e<=n.min&&(a=!0),e>=n.max&&(u=!0)),b.value!==u&&(b.value=u),m.value!==a&&(m.value=a)},C=()=>{const e=$(i.value),a=_(e);(e!==i.value||o.value!==a)&&(o.value=a),t("update:modelValue",e)};E(()=>[n.max,n.min],()=>{C(),h(i.value)});const N=(e,a)=>{if(f.value||e==="plus"&&b.value||e==="minus"&&m.value)return;let u;c(i.value)?u=$(V[e](i.value,n.step)):u=n.min===-1/0?0:n.min,o.value=_(u),h(u),t("update:modelValue",u),t("change",u,a)},p=(e,a,u=!1)=>{var d;e.preventDefault(),!n.readOnly&&((d=M.value)==null||d.focus(),N(a,e),u&&(x=window.setTimeout(()=>e.target.dispatchEvent(e),x?ve:fe)))},k=(e,a)=>{var u,d,O,D;e=e.trim().replace(/ã€‚/g,"."),e=(d=(u=n.parser)==null?void 0:u.call(n,e))!=null?d:e,(c(Number(e))||/^(\.|-)$/.test(e))&&(o.value=(D=(O=n.formatter)==null?void 0:O.call(n,e))!=null?D:e,h(i.value),t("input",i.value,o.value,a),n.modelEvent==="input"&&(t("update:modelValue",i.value),t("change",i.value,a)))},T=e=>{t("focus",e)},H=(e,a)=>{a instanceof MouseEvent&&!e||(C(),t("change",i.value,a))},U=e=>{t("blur",e)},j=e=>{var a,u;o.value="",t("update:modelValue",void 0),t("change",void 0,e),(u=(a=K.value)==null?void 0:a.onChange)==null||u.call(a,e),t("clear",e)},W=ce(new Map([[z.ARROW_UP,e=>{e.preventDefault(),!n.readOnly&&N("plus",e)}],[z.ARROW_DOWN,e=>{e.preventDefault(),!n.readOnly&&N("minus",e)}]])),Y=e=>{t("keydown",e),e.defaultPrevented||W(e)};E(()=>n.modelValue,e=>{e!==i.value&&(o.value=_(e),h(e))});const G=()=>{var e,a,u;return n.readOnly?null:s(ae,null,[l.suffix&&s("div",{class:`${r}-suffix`},[(e=l.suffix)==null?void 0:e.call(l)]),s("div",{class:`${r}-step`},[s("button",{class:[`${r}-step-button`,{[`${r}-step-button-disabled`]:f.value||b.value}],type:"button",tabindex:"-1",disabled:f.value||b.value,onMousedown:d=>p(d,"plus",!0),onMouseup:v,onMouseleave:v},[l.plus?(a=l.plus)==null?void 0:a.call(l):s(ee,null,null)]),s("button",{class:[`${r}-step-button`,{[`${r}-step-button-disabled`]:f.value||m.value}],type:"button",tabindex:"-1",disabled:f.value||m.value,onMousedown:d=>p(d,"minus",!0),onMouseup:v,onMouseleave:v},[l.minus?(u=l.minus)==null?void 0:u.call(l):s(ne,null,null)])])])},L=B(()=>[r,`${r}-mode-${n.mode}`,`${r}-size-${g.value}`,{[`${r}-readonly`]:n.readOnly}]),Q=()=>s(R,{size:g.value,tabindex:"-1",class:`${r}-step-button`,disabled:f.value||m.value,onMousedown:e=>p(e,"minus",!0),onMouseup:v,onMouseleave:v},{icon:()=>s(le,null,null)}),q=()=>s(R,{size:g.value,tabindex:"-1",class:`${r}-step-button`,disabled:f.value||b.value,onMousedown:e=>p(e,"plus",!0),onMouseup:v,onMouseleave:v},{icon:()=>s(ue,null,null)});return{inputRef:M,render:()=>{const e=n.mode==="embed"?{prepend:l.prepend,prefix:l.prefix,suffix:n.hideButton?l.suffix:G,append:l.append}:{prepend:n.hideButton?l.prepend:Q,prefix:l.prefix,suffix:l.suffix,append:n.hideButton?l.append:q};return s(se,{key:`__arco__${n.mode}`,ref:M,class:L.value,type:"text",allowClear:n.allowClear,size:g.value,modelValue:o.value,placeholder:n.placeholder,disabled:f.value,readonly:n.readOnly,error:n.error,inputAttrs:{role:"spinbutton","aria-valuemax":n.max,"aria-valuemin":n.min,"aria-valuenow":o.value,...n.inputAttrs},onInput:k,onFocus:T,onBlur:U,onClear:j,onChange:H,onKeydown:Y},e)}}},methods:{focus(){var n;(n=this.inputRef)==null||n.focus()},blur(){var n;(n=this.inputRef)==null||n.blur()}},render(){return this.render()}});const he=Object.assign(I,{install:(n,t)=>{ie(n,t);const l=re(t);n.component(l+I.name,I)}});export{he as I};
