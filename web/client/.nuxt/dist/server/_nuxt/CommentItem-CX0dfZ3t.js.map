{"version":3,"file":"CommentItem-CX0dfZ3t.js","sources":["../../../../components/CommentItem.vue"],"sourcesContent":["<template>\r\n    <div class=\"comment-item\">\r\n        <div class=\"comment-avatar\">\r\n            <img :src=\"data.user?.n_avatar || '/default-avatar.png'\" :alt=\"data.user?.n_nickname\">\r\n        </div>\r\n        <div class=\"comment-content\">\r\n            <div class=\"comment-header\">\r\n                <span class=\"comment-author\">{{ data.user?.n_nickname || '匿名用户' }}</span>\r\n                <a-tag v-if=\"isAuthor\" size=\"mini\" color=\"arcoblue\">作者</a-tag>\r\n                <span class=\"comment-time\">{{ formatTime(data.n_time) }}</span>\r\n            </div>\r\n            <div class=\"comment-body\" v-html=\"data.n_html\"></div>\r\n\r\n            <div v-if=\"data.thread\" class=\"Hbs\">\r\n                回复帖子：<span @click=\"navigateTo('/threads/' +  data.thread.id)\">{{ data.thread.n_name }}</span>\r\n            </div>\r\n            <div class=\"comment-actions\">\r\n                <a-popconfirm @ok=\"DelComments(data.id)\" content=\"确定删除吗?\" type=\"error\">\r\n                    <a-button status=\"danger\" v-if=\"UserInfo.$state.UserInfo?.id == data.n_uid\" class=\"action-btn\"\r\n                        size=\"mini\" style=\"border-radius: 20px;\">\r\n                        <template #icon>\r\n                            <icon-delete />\r\n                        </template>\r\n                        删除评论\r\n                    </a-button>\r\n                </a-popconfirm>\r\n\r\n            </div>\r\n            <div class=\"comment-reply\">\r\n                <slot></slot>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Message } from '@arco-design/web-vue';\r\nconst UserInfo = useUserInfo()\r\nconst props = defineProps({\r\n    data: {\r\n        type: Object,\r\n        required: true,\r\n        default: () => ({}),\r\n    },\r\n    isAuthor: {\r\n        type: Boolean,\r\n        default: false,\r\n    }\r\n})\r\nconst emit = defineEmits(['reply', 'like'])\r\n\r\nconst formatTime = (timeStr) => {\r\n    if (!timeStr) return ''\r\n    const date = new Date(timeStr)\r\n    const now = new Date()\r\n    const diff = now - date\r\n\r\n    const minute = 60 * 1000\r\n    const hour = 60 * minute\r\n    const day = 24 * hour\r\n\r\n    if (diff < minute) {\r\n        return '刚刚'\r\n    } else if (diff < hour) {\r\n        return Math.floor(diff / minute) + '分钟前'\r\n    } else if (diff < day) {\r\n        return Math.floor(diff / hour) + '小时前'\r\n    } else if (diff < day * 7) {\r\n        return Math.floor(diff / day) + '天前'\r\n    } else {\r\n        return date.toLocaleDateString('zh-CN', {\r\n            year: 'numeric',\r\n            month: '2-digit',\r\n            day: '2-digit',\r\n            hour: '2-digit',\r\n            minute: '2-digit'\r\n        })\r\n    }\r\n}\r\n\r\n/* 删除评论 DelComments */\r\nconst DelComments = async (id) => {\r\n\r\n    try {\r\n        const res = await useApiFetch().post('/api/DelComments', { id })\r\n        if (res.code == 200) {\r\n            Message.success('删除评论成功')\r\n            emit('reload')\r\n        } else {\r\n            Message.error(res.message || '删除评论失败')\r\n        }\r\n\r\n    } catch (error) {\r\n\r\n        Message.error(error.message)\r\n\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.comment-item {\r\n    display: flex;\r\n    gap: 12px;\r\n    padding: 16px;\r\n    background-color: #fff;\r\n    border-radius: 12px;\r\n    margin-bottom: 12px;\r\n    transition: background-color 0.2s;\r\n\r\n    &:hover {\r\n        background-color: #f8f9fa;\r\n    }\r\n\r\n    .comment-avatar {\r\n        flex-shrink: 0;\r\n\r\n        img {\r\n            width: 30px;\r\n            height: 30px;\r\n            border-radius: 50%;\r\n            object-fit: cover;\r\n            border: 2px solid #f0f0f0;\r\n        }\r\n    }\r\n\r\n    .comment-content {\r\n        flex: 1;\r\n        min-width: 0;\r\n\r\n        .comment-header {\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 10px;\r\n            margin-bottom: 8px;\r\n\r\n            .comment-author {\r\n                font-size: 14px;\r\n                font-weight: 600;\r\n                color: #333;\r\n            }\r\n\r\n            .comment-time {\r\n                font-size: 12px;\r\n                color: #999;\r\n            }\r\n        }\r\n\r\n        .comment-body {\r\n            font-size: 14px;\r\n            line-height: 1.6;\r\n            color: #555;\r\n            margin-bottom: 12px;\r\n            word-break: break-word;\r\n\r\n            :deep(img) {\r\n                max-width: 100%;\r\n                border-radius: 8px;\r\n            }\r\n\r\n            :deep(a) {\r\n                color: #00d181;\r\n                text-decoration: none;\r\n\r\n                &:hover {\r\n                    text-decoration: underline;\r\n                }\r\n            }\r\n        }\r\n        .Hbs{\r\n            font-size: 12px;\r\n            background-color: #f7f7f7;\r\n            padding: 10px;\r\n            border-radius: 10px;\r\n            span{\r\n                color: #00d181;\r\n                cursor: pointer;\r\n            }\r\n        }\r\n\r\n        .comment-actions {\r\n            display: flex;\r\n            gap: 8px;\r\n\r\n            .action-btn {\r\n                display: flex;\r\n                align-items: center;\r\n                gap: 4px;\r\n                padding: 6px 12px;\r\n                border: none;\r\n                background-color: #f5f5f5;\r\n                border-radius: 16px;\r\n                font-size: 12px;\r\n                color: #666;\r\n                cursor: pointer;\r\n                transition: all 0.2s;\r\n\r\n                &:hover {\r\n                    background-color: #e0e0e0;\r\n                    color: #333;\r\n                }\r\n\r\n                &:active {\r\n                    transform: scale(0.98);\r\n                }\r\n\r\n                svg {\r\n                    flex-shrink: 0;\r\n                }\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_push","_parent","_unref","_","_scopeId","_createVNode","_createBlock"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAqCA,UAAM,WAAW,YAAW;AAY5B,UAAM,OAAO;AAEb,UAAM,aAAa,CAAC,YAAY;AAC5B,UAAI,CAAC,QAAS,QAAO;AACrB,YAAM,OAAO,IAAI,KAAK,OAAO;AAC7B,YAAM,MAAM,oBAAI,KAAI;AACpB,YAAM,OAAO,MAAM;AAEnB,YAAM,SAAS,KAAK;AACpB,YAAM,OAAO,KAAK;AAClB,YAAM,MAAM,KAAK;AAEjB,UAAI,OAAO,QAAQ;AACf,eAAO;AAAA,MACX,WAAW,OAAO,MAAM;AACpB,eAAO,KAAK,MAAM,OAAO,MAAM,IAAI;AAAA,MACvC,WAAW,OAAO,KAAK;AACnB,eAAO,KAAK,MAAM,OAAO,IAAI,IAAI;AAAA,MACrC,WAAW,OAAO,MAAM,GAAG;AACvB,eAAO,KAAK,MAAM,OAAO,GAAG,IAAI;AAAA,MACpC,OAAO;AACH,eAAO,KAAK,mBAAmB,SAAS;AAAA,UACpC,MAAM;AAAA,UACN,OAAO;AAAA,UACP,KAAK;AAAA,UACL,MAAM;AAAA,UACN,QAAQ;AAAA,QACpB,CAAS;AAAA,MACL;AAAA,IACJ;AAGA,UAAM,cAAc,OAAO,OAAO;AAE9B,UAAI;AACA,cAAM,MAAM,MAAM,YAAW,EAAG,KAAK,oBAAoB,EAAE,IAAI;AAC/D,YAAI,IAAI,QAAQ,KAAK;AACjB,kBAAQ,QAAQ,QAAQ;AACxB,eAAK,QAAQ;AAAA,QACjB,OAAO;AACH,kBAAQ,MAAM,IAAI,WAAW,QAAQ;AAAA,QACzC;AAAA,MAEJ,SAAS,OAAO;AAEZ,gBAAQ,MAAM,MAAM,OAAO;AAAA,MAE/B;AAAA,IAEJ;;;;;;mBAjGSA,eAAAC,WAAA,EAAA,OAAM,eAAc,GAAA,MAAA,CAAA,qEAEXC,cAAA,OAAK,QAAA,KAAK,MAAM,YAAQ,qBAAA,IAA4BA,cAAA,OAAK,QAAA,KAAK,MAAM,UAAU,gLAIhD,QAAA,KAAK,MAAM,cAAU,MAAA;UACxC,QAAA,UAAQ;;UAAE,MAAK;AAAA,UAAO,OAAM;AAAA;2BAAzC,CAA8D,GAAAC,QAAAC,UAAA,aAAA;;;;;gCAAV,IAAE;AAAA;;;;;;;;yEACxB,WAAW,QAAA,KAAK,MAAM,CAAA,2DAEtB,QAAA,KAAK,UAAM;AAElC,UAAA,QAAA,KAAK,QAAM;6FAC+C,QAAA,KAAK,OAAO,MAAM,CAAA,eAAA;AAAA;;;;;QAGpE,MAAE,YAAE,YAAY,QAAA,KAAK,EAAE;AAAA,QAAG,SAAQ;AAAA,QAAS,MAAK;AAAA;yBAA/D,CAQe,GAAAD,QAAAC,UAAA,aAAA;;gBAPqBC,MAAA,QAAA,EAAS,OAAO,UAAU,MAAM,QAAA,KAAK,OAAK;;gBAAhE,QAAO;AAAA,gBAA2D,OAAM;AAAA,gBAC9E,MAAK;AAAA,gBAAO,OAAA,EAAA,iBAAA,OAAA;AAAA;gBACD,cAAX,CAEWC,IAAAH,QAAAC,UAAAG,cAAA;;;;;sBADPC,YAAe,sBAAA;AAAA;;;iCAHvB,CAMWF,IAAAH,QAAAC,UAAAG,cAAA;;;;;sCAFI,QAEf;AAAA;;;;;;;;;;cANgCF,MAAA,QAAA,EAAS,OAAO,UAAU,MAAM,QAAA,KAAK,sBAArEI,YAMW,qBAAA;AAAA;gBAND,QAAO;AAAA,gBAA2D,OAAM;AAAA,gBAC9E,MAAK;AAAA,gBAAO,OAAA,EAAA,iBAAA,OAAA;AAAA;gBACD,cACP,MAAe;AAAA,kBAAfD,YAAe,sBAAA;AAAA;iCACR,MAEf;AAAA,kCAFe,QAEf;AAAA;;;;;;;;;;;;;;;;;;;;;"}