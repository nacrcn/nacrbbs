{"version":3,"file":"sign-Dj0FQ60N.js","sources":["../../../../pages/index/user/index/activity/sign.vue"],"sourcesContent":["<template>\r\n    <div class=\"vip-page\">\r\n        <UserHeader title=\"每日签到\"></UserHeader>\r\n        <div class=\"Page\">\r\n\r\n            <div class=\"Pagecontent\">\r\n                <p class=\"title\">每日签到</p>\r\n\r\n                <div class=\"TimeBox\">\r\n                    <div :class=\"['TimeBoxTitle', { active: value.Info }]\" v-for=\"value in currentMonthDayList.days\">\r\n                        {{ value.day }}\r\n\r\n                        <p class=\"signstatus\">\r\n                        <p v-if=\"!value.Info\">未签到</p>\r\n                        <p class=\"signtrue\" v-else>{{ value.Info.n_reward_type === '1' ? '积分' : '余额' }}*{{\r\n                            value.Info.n_reward_number }}</p>\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n\r\n                <div>\r\n                    <a-button :loading=\"loading\" v-if=\"!isTodayCheckedIn\" type=\"primary\" class=\"signbutton\" size=\"small\"\r\n                        @click=\"checkIn()\">\r\n                        立即签到 (奖励 {{ checkInReward?.Config?.n_reward_type === '1' ? '积分' : '余额' }}*{{ checkInReward.Today\r\n                        }})\r\n                    </a-button>\r\n                    <a-result v-if=\"isTodayCheckedIn\" status=\"success\" title=\"今日已签到\">\r\n                        <template #subtitle>\r\n                            <p class=\"signsta\">已发放 {{ isTodayCheckedIn.n_reward_type === '1' ? '积分' : '余额' }} * {{\r\n                                isTodayCheckedIn.n_reward_number }}</p>\r\n                            <div class=\"continuousDays\">\r\n                                您已连续签到{{ isTodayCheckedIn.continuousDays ?? 1 }}天，明日签到将获得{{ checkInReward.Tomorrow }}{{\r\n                                    checkInReward.Config.n_reward_type === '1' ? '积分' : '余额' }}\r\n                            </div>\r\n                        </template>\r\n                    </a-result>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { Message } from '@arco-design/web-vue';\r\n\r\n/* 今日是否签到 */\r\nconst isTodayCheckedIn = ref(false);\r\n\r\n\r\nfunction getCurrentMonthDayList() {\r\n    const now = new Date()\r\n    const year = now.getFullYear()\r\n    const month = now.getMonth() + 1 // 1-12\r\n\r\n    // 当月天数\r\n    const daysInMonth = new Date(year, month, 0).getDate()\r\n\r\n    const days = Array.from({ length: daysInMonth }, (_, i) => {\r\n        const day = i + 1\r\n        const date = `${year}-${String(month).padStart(2, '0')}-${String(day).padStart(2, '0')}`\r\n        return {\r\n            day,\r\n            date\r\n        }\r\n    })\r\n\r\n    return {\r\n        year,\r\n        month,\r\n        days\r\n    }\r\n}\r\n\r\n/* 判断今日是否签到函数 */\r\nfunction isCheckedInToday(date) {\r\n    for (let i = 0; i < checkInList.value.length; i++) {\r\n        if (checkInList.value[i].n_time === date) {\r\n            return checkInList.value[i]\r\n        }\r\n    }\r\n\r\n    return false\r\n}\r\nconst getCurrentDate = () => {\r\n    const date = new Date();\r\n    const year = date.getFullYear();\r\n    const month = date.getMonth() + 1;\r\n    const day = date.getDate();\r\n    return `${year}-${month}-${day}`;\r\n}\r\n/* 获取签到记录 /api/checkInList */\r\nconst checkInList = ref([])\r\nconst currentMonthDayList = ref([]);\r\n\r\nconst getCheckInList = async () => {\r\n    const res = await useApiFetch().post('/api/checkInList')\r\n    if (res.code === 200) {\r\n        checkInList.value = res.data\r\n        currentMonthDayList.value = getCurrentMonthDayList()\r\n        for (let a = 0; a < currentMonthDayList.value.days.length; a++) {\r\n            currentMonthDayList.value.days[a].Info = isCheckedInToday(currentMonthDayList.value.days[a].date)\r\n        }\r\n\r\n        isTodayCheckedIn.value = isCheckedInToday(getCurrentDate())\r\n    }\r\n}\r\n\r\n\r\n/* 签到 /api/checkIn */\r\nconst loading = ref(false)\r\nconst checkIn = async () => {\r\n    loading.value = true\r\n    const res = await useApiFetch().post('/api/checkIn')\r\n    if (res.code === 200) {\r\n        getCheckInList()\r\n    } else {\r\n        Message.error(res.msg)\r\n    }\r\n    loading.value = false\r\n}\r\n\r\n/* 获取今日和明日奖励 /api/getCheckInReward */\r\nconst checkInReward = ref({})\r\nconst getCheckInReward = async () => {\r\n\r\n    const res = await useApiFetch().post('/api/getCheckInReward')\r\n    if (res.code === 200) {\r\n        checkInReward.value = res.data\r\n    }\r\n}\r\n\r\nonMounted(() => {\r\n    getCheckInList()\r\n    getCheckInReward()\r\n})\r\n\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.vip-page {\r\n}\r\n\r\n.Page {\r\n    background-color: #fff;\r\n    width: calc(100% - 50px);\r\n    border-radius: 8px;\r\n    overflow: hidden;\r\n    margin: 0px auto;\r\n    padding: 25px;\r\n    border-radius: 20px;\r\n\r\n    .Pagecontent {\r\n        .title {\r\n            font-size: 17px;\r\n            font-weight: 600;\r\n            color: #333;\r\n            text-align: center;\r\n        }\r\n\r\n        .TimeBox {\r\n            display: grid;\r\n            /* 长度自适应 */\r\n            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));\r\n            gap: 10px;\r\n            margin-top: 30px;\r\n            margin-bottom: 30px;\r\n\r\n            .TimeBoxTitle {\r\n                background-color: #f6f6f6;\r\n                padding: 10px;\r\n                border-radius: 10px;\r\n                text-align: center;\r\n\r\n                .signstatus {\r\n                    margin-top: 10px;\r\n                    font-size: 10px;\r\n                    color: #666;\r\n\r\n                    .signtrue {\r\n                        color: #ff3c00;\r\n                        white-space: nowrap;\r\n                    }\r\n                }\r\n            }\r\n\r\n            .active {\r\n                background-color: #ff4336;\r\n                color: #fff;\r\n\r\n                .signstatus {\r\n                    .signtrue {\r\n                        color: #fff;\r\n\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        .signbutton {\r\n            width: 100%;\r\n            margin-top: 10px;\r\n            margin-bottom: 10px;\r\n            text-align: center;\r\n            border-radius: 20px;\r\n            height: 40px;\r\n            background-color: #ff3c00;\r\n        }\r\n    }\r\n}\r\n\r\n.signsta {\r\n    font-size: 11px;\r\n    color: #666;\r\n}\r\n\r\n.continuousDays {\r\n    margin-top: 10px;\r\n    font-size: 12px;\r\n    color: #666;\r\n    text-align: center;\r\n    background-color: #fff2ee;\r\n    display: block;\r\n    padding: 6px 10px;\r\n    border-radius: 10px;\r\n    color: #ff3c00;\r\n}\r\n</style>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderComponent","_unref","_ssrRenderClass","_ssrInterpolate","_push","_parent","_createTextVNode","_toDisplayString","_createVNode"],"mappings":"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"}